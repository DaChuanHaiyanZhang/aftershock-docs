import{_ as e,I as l,c as p,o as i,a5 as a,b as h,w as n,a as k,J as r,a6 as c}from"./chunks/framework.BOSSiFom.js";const b=JSON.parse('{"title":"My Account","description":"","frontmatter":{},"headers":[],"relativePath":"aftershockau/data-user-account.md","filePath":"aftershockau/data-user-account.md"}'),o={name:"aftershockau/data-user-account.md"};function d(E,s,g,u,y,A){const t=l("Mermaid");return i(),p("div",null,[s[1]||(s[1]=a(`<h1 id="my-account" tabindex="-1">My Account <a class="header-anchor" href="#my-account" aria-label="Permalink to “My Account”">​</a></h1><nav class="table-of-contents"><ul><li><a href="#数据源">数据源</a></li><li><a href="#组件引用结构链">组件引用结构链</a></li></ul></nav><p>用户个人中心</p><div class="danger custom-block github-alert"><p class="custom-block-title">DANGER</p><p>该界面只有用户登录状态下才可以查看和操作。</p></div><h2 id="数据源" tabindex="-1">数据源 <a class="header-anchor" href="#数据源" aria-label="Permalink to “数据源”">​</a></h2><p>该界面的数据是从 Shopify Storefront Api 中查询用户的数据。</p><ol><li>界面初始化时查询当前用户的信息<div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// account.jsx 核心代码</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> loader</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> context.storefront.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CUSTOMER_DETAILS_QUERY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    variables: { customerAccessToken },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li>当前用户的订单信息包含在界面初始化的信息当中。</li><li>界面切换时重新获取用户的个人信息，可编辑。<div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// account.profile.jsx 拉取数据代码</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> action</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">request</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> storefront.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CUSTOMER_DETAILS_QUERY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    variables: { customerAccessToken },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li>界面切换时获取用户的历史订单信息<div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// account.history.jsx</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> response</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> storefront.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">query</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">CUSTOMER_ORDERS_QUERY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  variables: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    customerAccessToken,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    first,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    after,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></li></ol><div class="warning custom-block github-alert"><p class="custom-block-title">WARNING</p><p><code>Outlet</code> 组件是否可以缓存用户的个人信息，这样可以避免重复调用。</p></div><h2 id="组件引用结构链" tabindex="-1">组件引用结构链 <a class="header-anchor" href="#组件引用结构链" aria-label="Permalink to “组件引用结构链”">​</a></h2>`,9)),(i(),h(c,null,{default:n(()=>[r(t,{id:"mermaid-53",class:"mermaid my-class",graph:"flowchart%20TB%0Aaccount.jsx%20--%3E%20AccountMenu%0Aaccount.jsx%20--%3E%20Outlet%0A%0AAccountMenu%20--PC--%3E%20AccountMenuDesktop%0AAccountMenu%20--Mobile--%3E%20AccountMenuMobile%0A%0AOutlet%20--%3E%20account.orders._index.jsx%0AOutlet%20--%3E%20account.profile.jsx%0AOutlet%20--%3E%20account.history.jsx%0A%0Aaccount.orders._index.jsx%20--%3E%20OrdersList%0Aaccount.orders._index.jsx%20--%3E%20EmptyOrders%0A%0Aaccount.history.jsx%20--%3E%20OrdersHistoryList%20--%3E%20OT%5Border-tracker.jsx%3Forder%3Dv%5D%0A"})]),fallback:n(()=>[...s[0]||(s[0]=[k(" Loading... ",-1)])]),_:1})),s[2]||(s[2]=a(`<p>该界面使用了 <code>Outlet</code> 的加载技术。</p><div class="note custom-block github-alert"><p class="custom-block-title">NOTE</p><p><a href="https://remix.org.cn/docs/en/main/components/outlet" target="_blank" rel="noreferrer">Outlet</a> 文档地址直通车。为 outlet 下面的元素树提供上下文值。当父路由需要向子路由提供值时使用。</p></div><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app\\routes\\account.jsx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app\\components\\Account\\AccountMenu\\AccountMenuDesktop\\index.jsx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app\\components\\Account\\AccountMenu\\AccountMenuMobile\\index.jsx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app\\routes\\account.orders._index.jsx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app\\components\\Account\\OrdersList\\index.jsx(EmptyOrders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app\\routes\\account.history.jsx</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">app\\components\\Account\\OrdersHistoryList\\index.jsx</span></span></code></pre></div>`,3))])}const f=e(o,[["render",d]]);export{b as __pageData,f as default};
