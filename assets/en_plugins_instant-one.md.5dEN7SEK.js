import{_ as i,c as t,o as a,a5 as n}from"./chunks/framework.BOSSiFom.js";const E=JSON.parse('{"title":"Instant.one Integration Guide","description":"","frontmatter":{},"headers":[],"relativePath":"en/plugins/instant-one.md","filePath":"en/plugins/instant-one.md"}'),e={name:"en/plugins/instant-one.md"};function l(h,s,p,r,k,d){return a(),t("div",null,[...s[0]||(s[0]=[n(`<h1 id="instant-one-integration-guide" tabindex="-1">Instant.one Integration Guide <a class="header-anchor" href="#instant-one-integration-guide" aria-label="Permalink to “Instant.one Integration Guide”">​</a></h1><nav class="table-of-contents"><ul><li><a href="#overview">Overview</a></li><li><a href="#core-process-and-technical-details">Core Process and Technical Details</a></li><li><a href="#core-concepts-of-event-tracking">Core Concepts of Event Tracking</a></li><li><a href="#available-events-overview">Available Events Overview</a></li><li><a href="#event-details-and-integration-guide">Event Details and Integration Guide</a><ul><li><a href="#page-viewed">PAGE_VIEWED</a></li><li><a href="#product-viewed">PRODUCT_VIEWED</a></li><li><a href="#item-added-to-cart">ITEM_ADDED_TO_CART</a></li><li><a href="#cart-viewed">CART_VIEWED</a></li><li><a href="#checkout-started">CHECKOUT_STARTED</a></li><li><a href="#collection-viewed">COLLECTION_VIEWED</a></li></ul></li><li><a href="#implementation-and-testing-recommendations">Implementation and Testing Recommendations</a></li><li><a href="#generic-typescript-type-reference">Generic TypeScript Type Reference</a></li></ul></nav><h2 id="overview" tabindex="-1">Overview <a class="header-anchor" href="#overview" aria-label="Permalink to “Overview”">​</a></h2><p><code>Instant.one</code> tracks users&#39; real-time behavior (such as browsing and adding to cart) in the <code>Aftershock</code> store and utilizes AI to analyze this data, thereby automatically sending highly personalized marketing emails to users to enhance engagement and conversion.</p><p><code>Klaviyo</code> tracks users&#39; behavior and transaction data in the <code>Aftershock</code> store and leverages its marketing automation platform to automatically send users highly personalized emails, SMS, and other multi-channel messages to nurture customer relationships and promote repeat purchases.</p><p>For details on how to integrate, please refer to the official documentation.</p><div class="important custom-block github-alert"><p class="custom-block-title">IMPORTANT</p><p>Official link: <a href="https://help.instant.one/installing-instant-ai-for-headless-shopify-sites" target="_blank" rel="noreferrer">https://help.instant.one/installing-instant-ai-for-headless-shopify-sites</a></p></div><h2 id="core-process-and-technical-details" tabindex="-1">Core Process and Technical Details <a class="header-anchor" href="#core-process-and-technical-details" aria-label="Permalink to “Core Process and Technical Details”">​</a></h2><p>The entire integration process revolves around data flow, with the specific technical implementation as follows:</p><ol><li><p><strong>Event Triggering and Collection</strong> When users browse, view products, or add items to cart in the Aftershock store, the <code>window.InstantJS.track()</code> method is called in the website code. This is the starting point of the entire data flow.</p></li><li><p><strong>Data Processing and Synchronization</strong> The Instant.one SDK captures these events. The key point is that Instant.one can not only forward raw data but also enrich and contextually analyze the data using its AI capabilities (e.g., determining user intent), then synchronize the standardized user behavior events to the Klaviyo platform in real-time. This is typically accomplished via Klaviyo&#39;s API.</p></li><li><p><strong>Marketing Automation Triggering</strong> In the Klaviyo backend, these events synchronized from Instant.one (such as <code>Product Viewed</code>, <code>Added to Cart</code>) are associated with specific user profiles. Corresponding automation workflows (Flows) can be created or triggered based on these events.</p></li></ol><h2 id="core-concepts-of-event-tracking" tabindex="-1">Core Concepts of Event Tracking <a class="header-anchor" href="#core-concepts-of-event-tracking" aria-label="Permalink to “Core Concepts of Event Tracking”">​</a></h2><p>Before starting the integration, it is helpful to understand the three core objects for Instant event tracking:</p><ul><li><strong><code>products</code></strong>: Describes products being viewed, used for <code>PAGE_VIEWED</code>, <code>COLLECTION_VIEWED</code>, <code>PRODUCT_VIEWED</code>.</li><li><strong><code>cart</code></strong>: Describes the complete state of the shopping cart, used for <code>CART_VIEWED</code>, <code>CHECKOUT_STARTED</code>.</li><li><strong><code>items</code></strong>: Describes the changed items in the shopping cart, used with <code>cart</code> for <code>ITEM_ADDED_TO_CART</code>.</li></ul><p>All events are sent via the global <code>window.InstantJS.track()</code> method. You can send events simultaneously to Instant and other service providers (such as Klaviyo).</p><hr><h2 id="available-events-overview" tabindex="-1">Available Events Overview <a class="header-anchor" href="#available-events-overview" aria-label="Permalink to “Available Events Overview”">​</a></h2><p>The table below lists all events that need to be tracked and their core purposes for quick reference. Detailed parameters and examples for each event are provided in subsequent sections.</p><table tabindex="0"><thead><tr><th style="text-align:left;">Event Type</th><th style="text-align:left;">Trigger Timing</th><th style="text-align:left;">Required Parameters</th><th style="text-align:left;">Core Purpose</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>PAGE_VIEWED</strong></td><td style="text-align:left;">When a user browses any page.</td><td style="text-align:left;"><code>products</code></td><td style="text-align:left;">Records product exposure associated with the page for personalized recommendations.</td></tr><tr><td style="text-align:left;"><strong>PRODUCT_VIEWED</strong></td><td style="text-align:left;">When a user views a product details page.</td><td style="text-align:left;"><code>products</code></td><td style="text-align:left;">Tracks specific product viewing behavior to analyze user interest.</td></tr><tr><td style="text-align:left;"><strong>ITEM_ADDED_TO_CART</strong></td><td style="text-align:left;">When a product is added to the cart.</td><td style="text-align:left;"><code>cart</code>, <code>items</code></td><td style="text-align:left;">Captures add-to-cart behavior for cart abandonment recovery and cart recommendations.</td></tr><tr><td style="text-align:left;"><strong>CART_VIEWED</strong></td><td style="text-align:left;">When a user opens the cart page.</td><td style="text-align:left;"><code>cart</code></td><td style="text-align:left;">Records the user&#39;s active action of viewing the cart.</td></tr><tr><td style="text-align:left;"><strong>CHECKOUT_STARTED</strong></td><td style="text-align:left;">When a user enters the checkout process.</td><td style="text-align:left;"><code>cart</code></td><td style="text-align:left;">Identifies a key conversion point for optimizing the checkout flow.</td></tr><tr><td style="text-align:left;"><strong>COLLECTION_VIEWED</strong></td><td style="text-align:left;">When a user browses a product category/collection page.</td><td style="text-align:left;"><code>products</code></td><td style="text-align:left;">Understands user preferences for product categories.</td></tr></tbody></table><hr><h2 id="event-details-and-integration-guide" tabindex="-1">Event Details and Integration Guide <a class="header-anchor" href="#event-details-and-integration-guide" aria-label="Permalink to “Event Details and Integration Guide”">​</a></h2><p>The following provides detailed explanations, example code, and parameter lists for each event.</p><h3 id="page-viewed" tabindex="-1">PAGE_VIEWED <a class="header-anchor" href="#page-viewed" aria-label="Permalink to “PAGE_VIEWED”">​</a></h3><p>Triggered when a user browses any page. You can send product information related to the current page upon page load to help Instant AI understand the context and provide personalized recommendations.</p><p><strong>TypeScript Function Example</strong></p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Example: Call in website global layout or page component</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> trackPageView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pageProducts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InteractionProduct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[])</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> eventPayloads</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InstantEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      provider: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSTANT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      event: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        products: pageProducts </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Pass the array of products to associate with the current page</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (window.InstantJS) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    window.InstantJS.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">track</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PAGE_VIEWED&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, eventPayloads);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">warn</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;InstantJS is not loaded&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Usage Example: On a product listing page, pass the first 3 products</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const productsOnPage = [...];</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// trackPageView(productsOnPage.slice(0, 3));</span></span></code></pre></div><p><strong>Event Payload Example</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window.InstantJS?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">track</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PAGE_VIEWED&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    provider: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSTANT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    event: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      products: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          product_id: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;prod_123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          product_sku: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TSHIRT-WHITE-M&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          product_name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Cotton White T-Shirt (Size M)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          price: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2999</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          currency: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CNY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          image: { url: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://cdn.example.com/tshirt-white.jpg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          online_store_url: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://shop.example.com/product/tshirt-white&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Important</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span></code></pre></div><p><strong><code>products</code> Parameter Description (InteractionProduct)</strong></p><table tabindex="0"><thead><tr><th style="text-align:left;">Parameter Name</th><th style="text-align:left;">Type</th><th style="text-align:left;">Required?</th><th style="text-align:left;">Description &amp; Example</th></tr></thead><tbody><tr><td style="text-align:left;"><strong><code>product_id</code></strong></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;"><strong>Yes</strong></td><td style="text-align:left;">Unique product ID. <code>&quot;prod_12345&quot;</code></td></tr><tr><td style="text-align:left;"><strong><code>product_sku</code></strong></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;"><strong>Yes</strong></td><td style="text-align:left;">Product SKU. <code>&quot;BLANKET-SMALL&quot;</code></td></tr><tr><td style="text-align:left;"><strong><code>product_name</code></strong></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;"><strong>Yes</strong></td><td style="text-align:left;">Product name. <code>&quot;Flannel Blanket&quot;</code></td></tr><tr><td style="text-align:left;"><strong><code>image</code></strong></td><td style="text-align:left;"><code>object</code></td><td style="text-align:left;"><strong>Yes</strong></td><td style="text-align:left;">Main image object, must contain <code>url</code>. <code>{url: &#39;https://...&#39;}</code></td></tr><tr><td style="text-align:left;"><code>online_store_url</code></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;"><strong>Strongly Recommended</strong></td><td style="text-align:left;">Product page link. Helps generate correct links.</td></tr><tr><td style="text-align:left;"><code>price</code></td><td style="text-align:left;"><code>number</code></td><td style="text-align:left;">No</td><td style="text-align:left;">Price (in the smallest currency unit, e.g., cents). <code>8900</code> represents 89.00 units.</td></tr><tr><td style="text-align:left;"><code>currency</code></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;">No</td><td style="text-align:left;">Currency code. <code>&quot;CNY&quot;</code>, <code>&quot;USD&quot;</code></td></tr><tr><td style="text-align:left;"><code>variant_id</code></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;">No</td><td style="text-align:left;">Variant ID. <code>&quot;var_678&quot;</code></td></tr></tbody></table><h3 id="product-viewed" tabindex="-1">PRODUCT_VIEWED <a class="header-anchor" href="#product-viewed" aria-label="Permalink to “PRODUCT_VIEWED”">​</a></h3><p>Triggered when a user views a single product&#39;s details page. This is one of the most critical events for understanding user interest.</p><p><strong>TypeScript Function Example</strong></p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> trackProductView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">product</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InteractionProduct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Note: The \`products\` property should be an array, even if containing only one product</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> eventPayloads</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InstantEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      provider: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSTANT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      event: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        products: [product] </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  window.InstantJS?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">track</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PRODUCT_VIEWED&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, eventPayloads);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Usage Example: Call in a React component&#39;s useEffect or Vue&#39;s mounted hook on the product detail page</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// useEffect(() =&gt; { trackProductView(currentProduct); }, [currentProduct]);</span></span></code></pre></div><p><strong>Event Payload Example</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window.InstantJS?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">track</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;PRODUCT_VIEWED&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    provider: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSTANT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    event: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      products: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          product_id: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;prod_456&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          product_sku: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;HOODIE-L-BLACK&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          product_name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Black Hoodie&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          product_brand: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;UrbanWear&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          variant_id: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;var_789&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          variant_title: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Size L / Black&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          price: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8900</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          currency: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CNY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          image: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            url: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://example.com/hoodie-black.jpg&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            alt: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Black Hoodie&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          handle: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;black-hoodie&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          online_store_url: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://shop.example.com/products/black-hoodie&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // Required</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span></code></pre></div><p><strong>Key Parameter Notes</strong> The <code>PRODUCT_VIEWED</code> event uses the <code>InteractionProduct</code> type, whose parameters are largely consistent with the table in the <code>PAGE_VIEWED</code> event. However, it is essential to provide more detailed product information, especially:</p><ul><li><strong><code>variant_id</code> and <code>variant_title</code></strong>: Must be provided if the product has specifications (like size, color) to ensure recommendation accuracy.</li><li><strong><code>online_store_url</code></strong>: Must be provided as it is the basis for generating the &quot;View Product&quot; button link.</li></ul><h3 id="item-added-to-cart" tabindex="-1">ITEM_ADDED_TO_CART <a class="header-anchor" href="#item-added-to-cart" aria-label="Permalink to “ITEM_ADDED_TO_CART”">​</a></h3><p>Triggered when a user adds a product to the shopping cart. This is the <strong>most critical and structurally unique</strong> event. Pay special attention to the distinction between <code>cart</code> and <code>items</code>.</p><p><strong>Core Data Structure Rules</strong>:</p><ul><li>The <code>items</code> array within the <code>cart</code> object: Must contain <strong>all products</strong> in the cart <strong>after the add operation</strong> (including existing and newly added ones).</li><li>The top-level <code>items</code> array: Should contain only the <strong>newly added item(s)</strong> from this specific operation.</li></ul><p><strong>TypeScript Function Example</strong></p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">/**</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * Sends the &#39;Item Added to Cart&#39; event</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> entireCart</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> The complete state of the cart after adding the new item(s)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> * </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">@param</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> addedItems</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> The one or more item(s) newly added in this operation</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> */</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> trackItemAddedToCart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  entireCart</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InteractionCart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  addedItems</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InteractionCartItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> eventPayloads</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InstantEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      provider: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSTANT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      event: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        cart: entireCart,   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Rule 1: The complete cart</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        items: addedItems   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Rule 2: Only the newly added items</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  window.InstantJS?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">track</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ITEM_ADDED_TO_CART&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, eventPayloads);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Usage Example: Call in the callback function of an &quot;Add to Cart&quot; button</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// const updatedCart = await api.addToCart(product);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// trackItemAddedToCart(updatedCart, [product]);</span></span></code></pre></div><p><strong>Event Payload Example</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Scenario: The cart originally had 1 &quot;T-Shirt&quot;, now 1 &quot;Hoodie&quot; is added</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">window.InstantJS?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">track</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ITEM_ADDED_TO_CART&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    provider: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSTANT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    event: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      cart: { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Represents the complete cart after addition</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        cart_url: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://shop.example.com/cart/abc123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        currency: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CNY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        grand_total: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">13800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        items: [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Rule 1: Contains all items (T-Shirt + Hoodie)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Original item</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            item_id: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cart_line_1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            product_id: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;prod_123&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            product_name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Cotton T-Shirt&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            quantity: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            price: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4900</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // ... other fields</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Newly added item (must also appear here)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            item_id: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cart_line_2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            product_id: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;prod_456&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            product_name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Black Hoodie&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            quantity: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Current total quantity is 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            price: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8900</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">            // ... other fields</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      items: [ </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Rule 2: Contains only the newly added &quot;Hoodie&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          item_id: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cart_line_2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// This ID corresponds to the item in cart.items above</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          product_id: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;prod_456&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          product_name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Black Hoodie&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          quantity: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Quantity added in this operation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          price: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8900</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          // ... other fields</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]);</span></span></code></pre></div><p><strong><code>cart</code> Parameter Table (InteractionCart)</strong></p><table tabindex="0"><thead><tr><th style="text-align:left;">Parameter Name</th><th style="text-align:left;">Type</th><th style="text-align:left;">Required?</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;"><strong><code>cart_url</code></strong></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;"><strong>Yes</strong></td><td style="text-align:left;">Cart page URL. <code>&quot;https://.../cart&quot;</code></td></tr><tr><td style="text-align:left;"><strong><code>items</code></strong></td><td style="text-align:left;"><code>InteractionCartItem[]</code></td><td style="text-align:left;"><strong>Yes</strong></td><td style="text-align:left;">Array of <strong>all products</strong> in the cart.</td></tr><tr><td style="text-align:left;"><code>cart_id</code></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;">No</td><td style="text-align:left;">Cart session ID.</td></tr><tr><td style="text-align:left;"><code>grand_total</code></td><td style="text-align:left;"><code>number</code></td><td style="text-align:left;">No</td><td style="text-align:left;">Total amount (in smallest currency unit).</td></tr><tr><td style="text-align:left;"><code>currency</code></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;">No</td><td style="text-align:left;">Currency code.</td></tr></tbody></table><p><strong><code>items</code> Parameter Table (InteractionCartItem)</strong> This type inherits from <code>InteractionProduct</code> and adds shopping-cart-item-specific fields.</p><table tabindex="0"><thead><tr><th style="text-align:left;">Parameter Name</th><th style="text-align:left;">Type</th><th style="text-align:left;">Required?</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;"><strong><code>item_id</code></strong></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;"><strong>Yes</strong></td><td style="text-align:left;"><strong>Cart line item ID</strong>, not the product ID. Used to uniquely identify a line in the cart.</td></tr><tr><td style="text-align:left;"><strong><code>quantity</code></strong></td><td style="text-align:left;"><code>number</code></td><td style="text-align:left;"><strong>Yes</strong></td><td style="text-align:left;">The <strong>total quantity</strong> of this product in the cart.</td></tr><tr><td style="text-align:left;"><code>item_name</code></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;">No</td><td style="text-align:left;">Item name, usually the same as <code>product_name</code>.</td></tr><tr><td style="text-align:left;">(All inherited parameters)</td><td style="text-align:left;"></td><td style="text-align:left;"></td><td style="text-align:left;">Such as <code>product_id</code>, <code>price</code>, <code>image</code> must also be provided.</td></tr></tbody></table><h3 id="cart-viewed" tabindex="-1">CART_VIEWED <a class="header-anchor" href="#cart-viewed" aria-label="Permalink to “CART_VIEWED”">​</a></h3><p>Triggered when a user views the shopping cart page.</p><p><strong>TypeScript Function Example</strong></p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> trackCartView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">currentCart</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InteractionCart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  window.InstantJS?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">track</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CART_VIEWED&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { provider: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSTANT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, event: { cart: currentCart } }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Usage Example: Call when the cart page component loads</span></span></code></pre></div><p><strong>Required Parameters</strong>: The <code>cart</code> object (structure is identical to that in the <code>ITEM_ADDED_TO_CART</code> event), needs to contain the latest information on all items in the cart.</p><h3 id="checkout-started" tabindex="-1">CHECKOUT_STARTED <a class="header-anchor" href="#checkout-started" aria-label="Permalink to “CHECKOUT_STARTED”">​</a></h3><p>Triggered when a user starts the checkout process (typically upon entering the checkout page or clicking the &quot;Proceed to Checkout&quot; button). This is a key node for measuring conversion rate.</p><p><strong>TypeScript Function Example</strong></p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> trackCheckoutStarted</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">checkoutCart</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InteractionCart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Ensure cart data reflects the final state at checkout</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  window.InstantJS?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">track</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;CHECKOUT_STARTED&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { provider: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSTANT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, event: { cart: checkoutCart } }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p><strong>Required Parameters</strong>: The <code>cart</code> object. It is recommended to provide as accurate monetary information as possible in this event, including:</p><ul><li><strong><code>grand_total</code></strong>: Order total.</li><li><strong><code>discounts</code></strong>: Array of applied discounts.</li><li><strong><code>shipping_total</code></strong>: Shipping cost.</li><li><strong><code>tax_total</code></strong>: Tax amount.</li></ul><h3 id="collection-viewed" tabindex="-1">COLLECTION_VIEWED <a class="header-anchor" href="#collection-viewed" aria-label="Permalink to “COLLECTION_VIEWED”">​</a></h3><p>Triggered when a user browses a product collection or category page.</p><p><strong>TypeScript Function Example</strong></p><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> trackCollectionView</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">collectionProducts</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InteractionProduct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[])</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Typically pass the list of products currently displayed on that collection page</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  window.InstantJS?.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">track</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;COLLECTION_VIEWED&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    { provider: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;INSTANT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, event: { products: collectionProducts } }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Usage Example: When a category page loads, pass the products from the first screen</span></span></code></pre></div><p><strong>Required Parameters</strong>: An array of <code>products</code>, which should include representative products from that collection (e.g., the first 20 products on the current page). Core information like <code>product_id</code>, <code>product_name</code>, <code>image</code>, <code>online_store_url</code> should be provided for each product.</p><hr><h2 id="implementation-and-testing-recommendations" tabindex="-1">Implementation and Testing Recommendations <a class="header-anchor" href="#implementation-and-testing-recommendations" aria-label="Permalink to “Implementation and Testing Recommendations”">​</a></h2><ol><li><strong>Implementation Order</strong>: It is recommended to implement and test in the following order: <code>PAGE_VIEWED</code> → <code>PRODUCT_VIEWED</code> → <code>ITEM_ADDED_TO_CART</code> → <code>CART_VIEWED</code> → <code>CHECKOUT_STARTED</code>.</li><li><strong>Testing Methods</strong>: <ul><li>In the browser&#39;s Developer Tools <strong>Console</strong>, type <code>window.InstantJS.track</code> and press Enter to check if the function exists.</li><li>After triggering an event, filter for <code>instant</code> requests in the <strong>Network</strong> tab to view the sent data payload.</li><li>Validate key data: <ul><li>Check if <code>cart_url</code> and product <code>online_store_url</code> are complete URLs.</li><li>For <code>ITEM_ADDED_TO_CART</code>, verify that <code>cart.items</code> and the top-level <code>items</code> array follow the aforementioned rules.</li></ul></li></ul></li></ol><h2 id="generic-typescript-type-reference" tabindex="-1">Generic TypeScript Type Reference <a class="header-anchor" href="#generic-typescript-type-reference" aria-label="Permalink to “Generic TypeScript Type Reference”">​</a></h2><div class="language-typescript"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Event type enumeration</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InteractionType</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;PAGE_VIEWED&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;COLLECTION_VIEWED&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;PRODUCT_VIEWED&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ITEM_ADDED_TO_CART&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CART_VIEWED&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;CHECKOUT_STARTED&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Instant event payload type</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InstantEvent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  provider</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;INSTANT&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  event</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    cart</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InteractionCart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    items</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InteractionCartItem</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    products</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InteractionProduct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[];</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Other service provider type example (e.g., Klaviyo)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> KlaviyoEvent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  provider</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;KLAVIYO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">  event</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> any</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Define specific structure according to Klaviyo&#39;s official documentation</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Global window type extension</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">declare</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> global {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Window</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">    InstantJS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      track</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> InteractionType</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">body</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">InstantEvent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> KlaviyoEvent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> void</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    };</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div>`,70)])])}const c=i(e,[["render",l]]);export{E as __pageData,c as default};
